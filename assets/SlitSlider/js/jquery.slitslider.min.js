$.fn.slitsliderEmulateTransitionEnd=function(d){var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},f=b[Modernizr.prefixed("transition")];var c=false,a=this;$(this).one(f,function(){c=true});var e=function(){if(!c){$(a).trigger(f)}};setTimeout(e,d);return this};(function(g,h,d){var a=g.event,b,j;b=a.special.debouncedresize={setup:function(){g(this).on("resize",b.handler)},teardown:function(){g(this).off("resize",b.handler)},handler:function(o,k){var n=this,m=arguments,l=function(){o.type="debouncedresize";a.dispatch.apply(n,m)};if(j){clearTimeout(j)}k?l():j=setTimeout(l,b.threshold)},threshold:20};var c=g(h),f=g(document),e=h.Modernizr;g.Slitslider=function(k,l){this.$elWrapper=g(l);this._init(k)};g.Slitslider.defaults={speed:800,optOpacity:false,translateFactor:230,maxAngle:25,maxScale:2,autoplay:false,keyboard:true,interval:4000,onBeforeChange:function(l,k){return false},onAfterChange:function(l,k){return false}};g.Slitslider.prototype={_init:function(k){this.options=g.extend(true,{},g.Slitslider.defaults,k);this.transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=this.transEndEventNames[e.prefixed("transition")];this.support=e.csstransitions&&e.csstransforms3d;this.$el=this.$elWrapper.children(".sl-slider");this.$slides=this.$el.children(".sl-slide").hide();this.slidesCount=this.$slides.length;this.current=0;this.isAnimating=false;this._getSize();this._layout();this._loadEvents();if(this.options.autoplay){this._startSlideshow()}},_getSize:function(){this.size={width:this.$elWrapper.outerWidth(true),height:this.$elWrapper.outerHeight(true)}},_layout:function(){this.$slideWrapper=g('<div class="sl-slides-wrapper" />');this.$slides.wrapAll(this.$slideWrapper).each(function(l){var m=g(this),k=m.data("orientation");m.addClass("sl-slide-"+k).children().wrapAll('<div class="sl-content-wrapper" />').wrapAll('<div class="sl-content" />')});this._setSize();this.$slides.eq(this.current).show()},_navigate:function(o,t){if(this.isAnimating||this.slidesCount<2){return false}this.isAnimating=true;var w=this,q=this.$slides.eq(this.current);if(t!==d){this.current=t}else{if(o==="next"){this.current=this.current<this.slidesCount-1?++this.current:0}else{if(o==="prev"){this.current=this.current>0?--this.current:this.slidesCount-1}}}this.options.onBeforeChange(q,this.current);var n=this.$slides.eq(this.current),s=(o==="next")?q:n,p=s.data(),m={};m.orientation=p.orientation||"horizontal",m.slice1angle=p.slice1Rotation||0,m.slice1scale=p.slice1Scale||1,m.slice2angle=p.slice2Rotation||0,m.slice2scale=p.slice2Scale||1;this._validateValues(m);var u=m.orientation==="horizontal"?{marginTop:-this.size.height/2}:{marginLeft:-this.size.width/2},l={transform:"translate(0%,0%) rotate(0deg) scale(1)",opacity:1},r=m.orientation==="horizontal"?{transform:"translateY(-"+this.options.translateFactor+"%) rotate("+m.slice1angle+"deg) scale("+m.slice1scale+")"}:{transform:"translateX(-"+this.options.translateFactor+"%) rotate("+m.slice1angle+"deg) scale("+m.slice1scale+")"},v=m.orientation==="horizontal"?{transform:"translateY("+this.options.translateFactor+"%) rotate("+m.slice2angle+"deg) scale("+m.slice2scale+")"}:{transform:"translateX("+this.options.translateFactor+"%) rotate("+m.slice2angle+"deg) scale("+m.slice2scale+")"};if(this.options.optOpacity){r.opacity=0;v.opacity=0}q.removeClass("sl-trans-elems");var k={transition:"all "+this.options.speed+"ms ease-in-out"};s.css("z-index",this.slidesCount).find("div.sl-content-wrapper").wrap(g('<div class="sl-content-slice" />').css(k)).parent().cond(o==="prev",function(){var x=this;this.css(r);setTimeout(function(){x.css(l)},50)},function(){var x=this;setTimeout(function(){x.css(r)},50)}).clone().appendTo(s).cond(o==="prev",function(){var x=this;this.css(v);setTimeout(function(){q.addClass("sl-trans-back-elems");if(w.support){x.css(l).on(w.transEndEventName,function(){w._onEndNavigate(x,q,o)}).slitsliderEmulateTransitionEnd(w.options.speed+100)}else{w._onEndNavigate(x,q,o)}},50)},function(){var x=this;setTimeout(function(){n.addClass("sl-trans-elems");if(w.support){x.css(v).on(w.transEndEventName,function(){w._onEndNavigate(x,q,o)}).slitsliderEmulateTransitionEnd(w.options.speed+100)}else{w._onEndNavigate(x,q,o)}},50)}).find("div.sl-content-wrapper").css(u);n.show()},_validateValues:function(k){if(k.slice1angle>this.options.maxAngle||k.slice1angle<-this.options.maxAngle){k.slice1angle=this.options.maxAngle}if(k.slice2angle>this.options.maxAngle||k.slice2angle<-this.options.maxAngle){k.slice2angle=this.options.maxAngle}if(k.slice1scale>this.options.maxScale||k.slice1scale<=0){k.slice1scale=this.options.maxScale}if(k.slice2scale>this.options.maxScale||k.slice2scale<=0){k.slice2scale=this.options.maxScale}if(k.orientation!=="vertical"&&k.orientation!=="horizontal"){k.orientation="horizontal"}},_onEndNavigate:function(n,m,l){var o=n.parent(),k="sl-trans-elems sl-trans-back-elems";n.remove();o.css("z-index",1).find("div.sl-content-wrapper").unwrap();m.hide().removeClass(k);o.removeClass(k);this.isAnimating=false;this.options.onAfterChange(o,this.current)},_setSize:function(){var k={width:this.size.width,height:this.size.height};this.$el.css(k).find("div.sl-content-wrapper").css(k)},_loadEvents:function(){var k=this;c.on("debouncedresize.slitslider",function(l){k._getSize();k._setSize()});if(this.options.keyboard){f.on("keydown.slitslider",function(n){var m=n.keyCode||n.which,l={left:37,up:38,right:39,down:40};switch(m){case l.left:k._stopSlideshow();k._navigate("prev");break;case l.right:k._stopSlideshow();k._navigate("next");break}})}},_startSlideshow:function(){var k=this;this.slideshow=setTimeout(function(){k._navigate("next");if(k.options.autoplay){k._startSlideshow()}},this.options.interval)},_stopSlideshow:function(){if(this.options.autoplay){clearTimeout(this.slideshow);this.isPlaying=false;this.options.autoplay=false}},_destroy:function(k){this.$el.off(".slitslider").removeData("slitslider");c.off(".slitslider");f.off(".slitslider");this.$slides.each(function(m){var n=g(this),l=n.find("div.sl-content").children();l.appendTo(n);n.children("div.sl-content-wrapper").remove()});this.$slides.unwrap(this.$slideWrapper).hide();this.$slides.eq(0).show();if(k){k.call()}},add:function(l,m){this.$slides=this.$slides.add(l);var k=this;l.each(function(o){var p=g(this),n=p.data("orientation");p.hide().addClass("sl-slide-"+n).children().wrapAll('<div class="sl-content-wrapper" />').wrapAll('<div class="sl-content" />').end().appendTo(k.$el.find("div.sl-slides-wrapper"))});this._setSize();this.slidesCount=this.$slides.length;if(m){m.call($items)}},next:function(){this._stopSlideshow();this._navigate("next")},previous:function(){this._stopSlideshow();this._navigate("prev")},jump:function(k){k-=1;if(k===this.current||k>=this.slidesCount||k<0){return false}this._stopSlideshow();this._navigate(k>this.current?"next":"prev",k)},play:function(){if(!this.isPlaying){this.isPlaying=true;this._navigate("next");this.options.autoplay=true;this._startSlideshow()}},pause:function(){if(this.isPlaying||this.options.autoplay){this._stopSlideshow()}},isActive:function(){return this.isAnimating},destroy:function(k){this._destroy(k)}};var i=function(k){if(h.console){h.console.error(k)}};g.fn.slitslider=function(m){var k=g.data(this,"slitslider");if(typeof m==="string"){var l=Array.prototype.slice.call(arguments,1);this.each(function(){if(!k){i("cannot call methods on slitslider prior to initialization; attempted to call method '"+m+"'");return}if(!g.isFunction(k[m])||m.charAt(0)==="_"){i("no such method '"+m+"' for slitslider self");return}k[m].apply(k,l)})}else{this.each(function(){if(k){k._init()}else{k=g.data(this,"slitslider",new g.Slitslider(m,this))}})}return k}})(jQuery,window);